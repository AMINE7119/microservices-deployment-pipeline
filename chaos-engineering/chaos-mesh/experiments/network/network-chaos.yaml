apiVersion: chaos-mesh.org/v1alpha1
kind: NetworkChaos
metadata:
  name: network-delay-experiment
  namespace: chaos-mesh
spec:
  action: delay
  mode: random-max-percent
  value: "50"
  selector:
    namespaces:
      - microservices
    labelSelectors:
      "app": "api-gateway"
  delay:
    latency: "100ms"
    correlation: "25"
    jitter: "10ms"
  duration: "5m"
  scheduler:
    cron: "@every 15m"
---
apiVersion: chaos-mesh.org/v1alpha1
kind: NetworkChaos
metadata:
  name: network-partition-experiment
  namespace: chaos-mesh
spec:
  action: partition
  mode: all
  selector:
    namespaces:
      - microservices
    labelSelectors:
      "app": "user-service"
  direction: both
  target:
    mode: all
    selector:
      namespaces:
        - microservices
      labelSelectors:
        "app": "product-service"
  duration: "2m"
---
apiVersion: chaos-mesh.org/v1alpha1
kind: NetworkChaos
metadata:
  name: packet-loss-experiment
  namespace: chaos-mesh
spec:
  action: loss
  mode: random-max-percent
  value: "30"
  selector:
    namespaces:
      - microservices
    labelSelectors:
      "app": "order-service"
  loss:
    loss: "25"
    correlation: "25"
  duration: "3m"
---
apiVersion: chaos-mesh.org/v1alpha1
kind: NetworkChaos
metadata:
  name: bandwidth-limit-experiment
  namespace: chaos-mesh
spec:
  action: bandwidth
  mode: all
  selector:
    namespaces:
      - microservices
    labelSelectors:
      "app": "frontend"
  bandwidth:
    rate: "1mbps"
    limit: 20971520
    buffer: 10000
  duration: "5m"
---
apiVersion: chaos-mesh.org/v1alpha1
kind: NetworkChaos
metadata:
  name: dns-chaos-experiment
  namespace: chaos-mesh
spec:
  action: dns
  mode: all
  selector:
    namespaces:
      - microservices
    labelSelectors:
      "app": "api-gateway"
  duration: "2m"